# i18n

---

# i18nとは

---

i18nとはアプリ内の言語を別の言語に切り替えることができる多言語化フレームワークです。

# インストール

---

Gemfileに以下の記述をし``bundle install``します。

```ruby
gem 'rails-i18n', '~> 7.0.0'
```

# デフォルトの言語設定

---

`config/application.rb`に以下の記述をすることでデフォルトの言語の設定を変えることができます。これによりロケールファイルの内 `ja`ファイルを翻訳に使うことができます。

```ruby
config.i18n.available_locales = %i[ja en]

config.i18n.default_locale = :ja  # デフォルトのlocaleを日本語(:ja)にする

# 以下の記述で複数のローケルファイルが読み込まれるようになる(必須)
config.i18n.load_path += Dir[Rails.root.join('config/locales/**/*.{rb,yml}').to_s]
```

# ロケールファイルの作成

---

翻訳に使う辞書ファイルをロケールファイルと呼び、`config/locales/`配下に設置します。拡張子は`rb`と`yml`形式があり、どちらを使用しても問題ありませんが`yml`形式の方が可読性が良いため　｀yml｀方式で書くのが良い。

ロケールファイルはActiveRecord用とView用を分けて用意すると管理がし易くなります。以下サンプルです。

`config/locales/activerecord.ja.yml`

```ruby
ja:
  activerecord:
    models:
      user: ユーザー
    attributes:
      user:
        email: メールアドレス
        last_name: 姓
        first_name: 名
        password: パスワード
        password_confirmation: パスワード確認
```

`config/locales/view/ja.yml`

```ruby
ja:
  helpers:
    submit:
      create: 登録
      submit: 保存
      update: 更新
    label:
      email: メールアドレス
      password: パスワード
  user_sessions:
    new:
      title: ログイン
      login: ログイン
      to_register_page: 登録ページへ
      password_forget: パスワードをお忘れの方はこちら
  users:
    new:
      title: ユーザー登録
      to_login_page: ログインページへ
  header:
    login: ログイン
    logout: ログアウト
    board: 掲示板
    board_index: 掲示板一覧
    create_board: 掲示板作成
    bookmark_index: ブックマーク一覧
    profile: プロフィール
```

i18nのGitHubにも各国のロケールファイルが用意されているようです。

[](https://github.com/svenfuchs/rails-i18n/blob/master/rails/locale/ja.yml)

# ロケールファイルの呼び出し

---

> 基本的な使い方
> 

```ruby
ja:
  activerecord:
    models:
      user: 'ユーザー'
    attributes:
      user:
        email: 'メールアドレス'
        password: 'パスワード'
```

上記のようなロケールファイルがあった場合

```ruby
<%= t('activerecord.models.user') %>
# => 「ユーザー」と表示

<%= t('activerecord.attributes.user.email') %>
# => 「メールアドレス」と表示
```

> form_withの場合
> 

form_withの場合は上記の例に則ると

```ruby
<%= form_with model: @user, local: true do |f| %>
  <%= f.label :email, t('activerecord.attributes.user.email') %>
  <%= f.email_field :email' %>
```

と記述することになるが、送信先に`model: @user`を使用している場合、自動でユーザーに関するフォームであると認識してくれるため自動で変換してくれる。そのため以下のように記述することができる。

```ruby
<%= form_with model: @user, local: true do |f| %>
  <%= f.label :email %>
  <%= f.email_field :email %>
```

> lazy look up
> 

```ruby
ja:
  users: # controller/usersに対応
    new: # newアクションに対応
      title: 'ユーザー登録'
```

```html
<h1><%= t('users.new.title') %></h1>
```

```html
<h1><%= t('.title') %></h1>
```

このように記述するだけで翻訳が実行されます。
